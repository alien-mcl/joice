!function(){"use strict";var a="object"==typeof process&&"object"==typeof process.versions&&"undefined"!=typeof process.versions.node;a?global.namespace=function(){return module.exports}:window.namespace||(window.namespace=function(a){if(void 0===a||null===a||"string"!=typeof a&&!(a instanceof String))return window;a=a instanceof String?a.toString():a;for(var b=a.split("."),c=window,d=0;d<b.length;d++)c=void 0===c[b[d]]||null===c[b[d]]?c[b[d]]={}:c[b[d]],c.__namespace=!0;return c})}(),function(){"use strict";String.format=function(a){if(void 0===a||null===a)return a;for(var b=[],c=1;c<arguments.length;c++)b.push((void 0===arguments[c]||null===arguments[c]?"":arguments[c].toString()).replace(/(\{|\})/g,function(a){return"_\\"+a}));var d=a.replace(/(\{\{\d\}\}|\{\d\})/g,function(a){if("{{"===a.substr(0,2))return a;var c=parseInt(a.substr(1,a.length-2));return b[c]});return d.replace(/(_\\\{|_\\\})/g,function(a){return a.substr(2,1)})}}(),function(){"use strict";Object.defineProperty(Function.prototype,":",{enumerable:!1,configurable:!1,value:function(a){function b(){this.constructor=c}var c=this;for(var d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);return b.prototype=a.prototype,c.prototype=new b,c}}),Object.defineProperty(Function,"requiresArgument",{enumerable:!1,configurable:!1,value:function(a,b,c){if(void 0===b)throw new joice.ArgumentException(a);if(null===b)throw new joice.ArgumentNullException(a);if(c&&!Function.is(b,c))throw new joice.ArgumentOutOfRangeException(a)}}),Object.defineProperty(Function,"requiresOptionalArgument",{enumerable:!1,configurable:!1,value:function(a,b,c){if(void 0!==b&&null!==b&&c&&!Function.is(b,c))throw new joice.ArgumentOutOfRangeException(a)}}),Object.defineProperty(Function,"is",{enumerable:!1,configurable:!1,value:function(a,b){return b?"string"==typeof b?typeof a===b:b instanceof Function?a===b||a instanceof b||a.prototype&&Function.is(a.prototype,b)?!0:Function.isInterface(b)?Function["implements"](a,b):!1:!0:!0}}),Object.defineProperty(Function,"implements",{enumerable:!1,configurable:!1,value:function(a,b){for(var c in b)if(b.hasOwnProperty(c)&&typeof a[c]!=typeof b[c])return!1;return!0}}),Object.defineProperty(Function,"isInterface",{enumerable:!1,configurable:!1,value:function(a){try{return new a,!1}catch(b){return!0}}})}(),function(a){"use strict";var b=(a.Exception=function(a){this.message||(this.message=a);var b=Error.prototype.constructor.call(this,this.message);b.name=this.name=this.constructor.toString(),Object.defineProperty(this,"stack",{get:function(){return b.stack}})})[":"](Error);a.Exception.dependencies=["message"],b.toString=function(){return"joice.Exception"}}(namespace("joice")),function(a){"use strict";var b=a.Resolver=function(){};b.prototype.isApplicableTo=function(a){return Function.requiresArgument("dependency",a,"string"),!1},b.prototype.resolve=function(a,b){return Function.requiresArgument("dependency",a,"string"),Function.requiresArgument("dependencyStack",b,Array),null},Object.defineProperty(b.prototype,"container",{enumerable:!1,configurable:!1,writable:!0,value:null}),Object.defineProperty(b.prototype,"normalize",{enumerable:!1,configurable:!1,writable:!1,value:function(a,b){for(var c=0;c<b.length;c++){var d=new RegExp(b[c]).exec(a);if(null!==d&&d.length>1){a=d[1];break}}return a}}),b.toString=function(){return"joice.Resolver"}}(namespace("joice")),function(a){"use strict";var b=a.ServiceDescriptor=function(a){Function.requiresArgument("serviceType",a,Function),this.serviceType=a,this.scope=joice.Scope.Transient};a.ServiceDescriptor.dependencies=["serviceType"],Object.defineProperty(b.prototype,"serviceType",{enumerable:!1,configurable:!1,writable:!0,value:null}),Object.defineProperty(b.prototype,"scope",{enumerable:!1,configurable:!1,writable:!0,value:null}),b.prototype.register=function(a){Function.requiresArgument("container",a,joice.Container)},b.prototype.lifestyleSingleton=function(){return this.scope=joice.Scope.Singleton,this},b.prototype.lifestyleTransient=function(){return this.scope=joice.Scope.Transient,this},b.toString=function(){return"joice.ServiceDescriptor"}}(namespace("joice")),function(a){"use strict";var b=(a.ArgumentException=function(a){this.message||(this.message=String.format("Argument '{0}' is invalid.",a)),joice.Exception.prototype.constructor.call(this,this.message)})[":"](joice.Exception);a.ArgumentException.dependencies=["argumentName"],b.toString=function(){return"joice.ArgumentException"}}(namespace("joice")),function(a){"use strict";var b=(a.ArgumentNullException=function(a){this.message||(this.message=String.format("Argument '{0}' cannot be null.",a)),joice.ArgumentException.prototype.constructor.call(this,this.message)})[":"](joice.ArgumentException);a.ArgumentNullException.dependencies=["argumentName"],b.toString=function(){return"joice.ArgumentNullException"}}(namespace("joice")),function(a){"use strict";var b=(a.ArgumentOutOfRangeException=function(a){this.message||(this.message=String.format("Argument '{0}' is out of range.",a)),joice.ArgumentException.prototype.constructor.call(this,this.message)})[":"](joice.ArgumentException);a.ArgumentOutOfRangeException.dependencies=["argumentName"],b.toString=function(){return"joice.ArgumentOutOfRangeException"}}(namespace("joice")),function(a){"use strict";var b=(a.ArrayResolver=function(){})[":"](joice.Resolver);b.prototype.isApplicableTo=function(a){joice.Resolver.prototype.isApplicableTo.apply(this,arguments);var c=this.normalize.call(this,a,b.arrayIndicators);return c!==a},b.prototype.resolve=function(a,c){a=this.normalize.call(this,a,b.arrayIndicators);for(var d=[],e=this.container.findServices(a),f=0;f<e.length;f++){var g=this.container.resolveInternal(e[f],c);null!==g&&d.push(g)}return d},b.arrayIndicators=["^arrayOf(.*)","^collectionOf(.*)","^enumerationOf(.*)"],b.toString=function(){return"joice.ArrayResolver"}}(namespace("joice")),function(a){"use strict";var b={},c=a.Classes={};c.implementing=function(a){Function.requiresArgument("type",a,Function);var c=new joice.ConventionDescriptor(a,b.resolve.call(this,a,window,[],0));return c},c.maxResolutionDepth=4,c.toString=function(){return"joice.Classes"},b.is=function(a){return void 0===this.prototype||null===this.prototype?!1:this.prototype instanceof a?!0:b.is.call(this.prototype,a)},b.forbiddenProperties=[/^webkit.*/],b.forbiddenProperties.matches=function(a){for(var c=0;c<b.forbiddenProperties.length;c++){var d=b.forbiddenProperties[c];if(d===a||d.test(a))return!0}return!1},b.resolve=function(a,d,e,f){if(f>c.maxResolutionDepth)return e;for(var g in d)d.hasOwnProperty(g)&&(b.forbiddenProperties.matches(g)||d.hasOwnProperty(g)&&void 0!==d[g]&&null!==d[g]&&("object"==typeof d[g]&&d[g].__namespace?b.resolve.call(this,a,d[g],e,f+1):"function"==typeof d[g]&&-1===e.indexOf(d[g])&&b.is.call(d[g],a)&&e.push(d[g])));return e}}(namespace("joice")),function(a){"use strict";var b=a.Component={};b["for"]=function(a){return Function.requiresArgument("type",a,Function),new joice.ComponentDescriptor(a)},b.toString=function(){return"joice.Component"}}(namespace("joice")),function(a){"use strict";var b=(a.ComponentDescriptor=function(){joice.ServiceDescriptor.prototype.constructor.apply(this,arguments),this._implementationType=null,this._instance=null,this._factoryMethod=null,this._name=null,this._dependencies=null})[":"](joice.ServiceDescriptor);Object.defineProperty(b.prototype,"_implementationType",{enumerable:!1,configurable:!1,writable:!0,value:null}),Object.defineProperty(b.prototype,"_instance",{enumerable:!1,configurable:!1,writable:!0,value:null}),Object.defineProperty(b.prototype,"_factoryMethod",{enumerable:!1,configurable:!1,writable:!0,value:null}),Object.defineProperty(b.prototype,"_name",{enumerable:!1,configurable:!1,writable:!0,value:null}),Object.defineProperty(b.prototype,"_dependencies",{enumerable:!1,configurable:!1,writable:!0,value:null}),b.prototype.implementedBy=function(a){return Function.requiresArgument("implementationType",a,this.serviceType),this._implementationType=a,this._instance=null,this._factoryMethod=null,this._name=a.toString(),this},b.prototype.instance=function(a){return Function.requiresArgument("instance",a,this.serviceType),this._instance=a,this._implementationType=a.prototype,this._factoryMethod=null,this._name=a.prototype.toString(),this},b.prototype.usingFactoryMethod=function(a){return Function.requiresArgument("factoryMethod",a,Function),this._instance=null,this._implementationType=null,this._factoryMethod=a,this},b.prototype.named=function(a){if(Function.requiresArgument("name",a,"string"),0===a.length)throw new joice.ArgumentOutOfRangeException("name");return this._name=a,this},b.prototype.register=function(a){joice.ServiceDescriptor.prototype.register.apply(this,arguments);var b=new joice.Registration(this.serviceType,null!==this._factoryMethod?this._factoryMethod:this._instance||this._implementationType,null!==this._factoryMethod,this._name,this.scope);a.register(b)},b.toString=function(){return"joice.ComponentDescriptor"}}(namespace("joice")),function(a){"use strict";var b=["provider","factory"],c={},d=a.Container=function(){this._registrations=new joice.RegistrationsCollection(this),this._resolvers=[],this.withResolver(new joice.FactoryResolver).withResolver(new joice.TypeResolver).withResolver(new joice.ArrayResolver).withResolver(new joice.InstanceResolver)};Object.defineProperty(d.prototype,"_registrations",{enumerable:!1,configurable:!1,writable:!0,value:null}),Object.defineProperty(d.prototype,"_resolvers",{enumerable:!1,configurable:!1,writable:!0,value:null}),d.prototype.withResolver=function(a){return Function.requiresArgument("resolver",a,joice.Resolver),this._resolvers.push(a),a.container=this,this},d.prototype.register=function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];if(b instanceof joice.Registration)c.registerRegistration.call(this,b);else{if(!(b instanceof joice.ServiceDescriptor))throw new joice.ArgumentOutOfRangeException("registration");b.register(this)}}return this},d.prototype.resolve=function(a){Function.requiresArgument("type",a);var b=a instanceof Array;if(b){if(1!==a.length)throw new joice.ArgumentOutOfRangeException("type");a=a[0]}else if(!(a instanceof Function))throw new joice.ArgumentOutOfRangeException("type");var c,d=[];for(c=0;c<this._registrations.length;c++){var e=this._registrations[c];if((e._serviceType.prototype instanceof a||e._serviceType===a)&&(d.push(e),!b))break}if(!b&&0===d.length)throw new joice.InvalidOperationException(String.format("There are no components registered for service type of '{0}'.",a.toString()));for(c=0;c<d.length;c++)d[c]=this.resolveInternal(d[c],[]);return b?d:d[0]},d.prototype.resolveType=function(a){Function.requiresArgument("type",a);var b=a instanceof Array;if(b){if(1!==a.length)throw new joice.ArgumentOutOfRangeException("type");a=a[0]}else if(!(a instanceof Function))throw new joice.ArgumentOutOfRangeException("type");for(var c=[],d=0;d<this._registrations.length;d++){var e=this._registrations[d];if(null!==e._implementationType&&(e._serviceType.prototype instanceof a||e._serviceType===a)){if(!b)return e._implementationType;c.push(e._implementationType)}}if(b)return c;throw new joice.InvalidOperationException(String.format("There are no components registered for service type of '{0}'.",a.toString()))},d.toString=function(){return"joice.Container"},Object.defineProperty(d.prototype,"findType",{enumerable:!1,configurable:!1,writeable:!1,value:function(a){a=a.toLowerCase();var b=c.findTypeByNames.call(this,a,function(a){var b=[a._name];return null!==a._implementationType&&b[0]!==a._implementationType.toString()&&b.push(a._implementationType.toString()),b});return null!==b?b:c.findTypeByNames.call(this,a,function(a){return[a._serviceType.toString()]})}}),Object.defineProperty(d.prototype,"findServices",{enumerable:!1,configurable:!1,writeable:!1,value:function(a){var c=[];a=a.toLowerCase();for(var d=0;d<this._registrations.length;d++){var e=this._registrations[d],f=e._serviceType.toString();if(a!==f){f=f.split("."),f=f[f.length-1].toLowerCase();var g=f.replace(a,"");g!==f&&(0===g.length||g.length>0&&-1===b.indexOf(g))&&c.push(e)}else c.push(e)}return c}}),Object.defineProperty(d.prototype,"resolveInternal",{enumerable:!1,configurable:!1,writeable:!1,value:function(a,b){if(-1!==b.indexOf(a))throw new joice.InvalidOperationException(String.format("Dependency loop detected for type '{0}'.",a._implementationType));b.push(a);var d=c.resolveArguments.call(this,a,b);return b.pop(),c.resolveInstance.call(this,a,d)}}),Object.defineProperty(d.prototype,"findResolver",{enumerable:!1,configurable:!1,writeable:!1,value:function(a){for(var b=null,c=0;c<this._resolvers.length;c++)if(this._resolvers[c].isApplicableTo(a)){b=this._resolvers[c];break}return b}}),c.registerRegistration=function(a){if(Function.requiresArgument("registration",a,joice.Registration),-1!==this._registrations.indexOf(a._name))throw new joice.Exception(String.format("Registration with name of '{0}' already exists.",a._name));return this._registrations.push(a),this},c.resolveArguments=function(a,b){for(var c=[],d=0;d<a._dependencies.length;d++){var e=null,f=a._dependencies[d],g=this.findResolver.call(this,f);null!==g&&(e=g.resolve(f,b)),c.push(e)}return c},c.resolveInstance=function(a,b){if(a._scope===joice.Scope.Singleton&&null!==a._instance)return a._instance;var c;return null!==a._factoryMethod?c=a._factoryMethod(this):(b.splice(0,0,null),c=new(Function.prototype.bind.apply(a._implementationType,b))),a._scope===joice.Scope.Singleton?a._instance=c:c},c.findTypeByNames=function(a,b){for(var c=0;c<this._registrations.length;c++)for(var d=this._registrations[c],e=b(d),f=0;f<e.length;f++){var g=e[f];if(a===g)return d;if(g=g.split("."),g=g[g.length-1],-1!==g.toLowerCase().indexOf(a))return d}return null}}(namespace("joice")),function(a){"use strict";var b=(a.ConventionDescriptor=function(a,b){joice.ServiceDescriptor.prototype.constructor.apply(this,arguments),this._implementationTypes=b instanceof Array?b:null})[":"](joice.ServiceDescriptor);a.ConventionDescriptor.dependencies=["serviceType","implementationTypes"],Object.defineProperty(b.prototype,"_implementationTypes",{enumerable:!1,configurable:!1,writable:!0,value:null}),b.prototype.register=function(a){joice.ServiceDescriptor.prototype.register.apply(this,arguments);for(var b=0;b<this._implementationTypes.length;b++)a.register(new joice.Registration(this.serviceType,this._implementationTypes[b],!1,this.scope))},b.toString=function(){return"joice.ConventionDescriptor"}}(namespace("joice")),function(a){"use strict";var b=(a.FactoryResolver=function(){})[":"](joice.Resolver);b.prototype.isApplicableTo=function(a){Function.requiresArgument("dependency",a,"string");var c=this.normalize.call(this,a,b.factoryIndicators);return c!==a},b.prototype.resolve=function(a){a=this.normalize.call(this,a,b.factoryIndicators);var c="arrayOf"+a.substring(0,1).toUpperCase()+a.substring(1),d=this.container.findResolver(a),e=this.container.findResolver(c);if(null===d&&null===e)return null;var f={};return f.resolve=function(){return d.resolve(a,[])},f.resolveAll=function(){return e.resolve(c,[])},f},b.factoryIndicators=["(.*)Factory$","(.*)Factory$"]}(namespace("joice")),function(a){"use strict";var b=a.IComponentFactory=function(){throw new joice.InvalidOperationException("Cannot instantiate interface joice.IComponentFactory.")};b.resolve=function(){},b.resolveAll=function(){},b.toString=function(){return"joice.IComponentFactory"}}(namespace("joice")),function(a){"use strict";var b=(a.InstanceResolver=function(){})[":"](joice.Resolver);b.prototype.isApplicableTo=function(a){Function.requiresArgument("dependency",a,"string");var b=this.normalize.call(this,a,joice.ArrayResolver.arrayIndicators);return b=this.normalize.call(this,b,joice.TypeResolver.typeIndicators),b=this.normalize.call(this,b,joice.FactoryResolver.factoryIndicators),b===a},b.prototype.resolve=function(a,b){var c=this.container.findType(a);return null!==c?this.container.resolveInternal(c,b):null}}(namespace("joice")),function(a){"use strict";var b=(a.InvalidOperationException=function(){joice.Exception.prototype.constructor.apply(this,arguments)})[":"](joice.Exception);b.toString=function(){return"joice.InvalidOperationException"}}(namespace("joice")),function(a){"use strict";var b={},c=a.Registration=function(a,c){if(Function.requiresArgument("serviceType",a,Function),Function.requiresArgument("implementation",c),!(c instanceof Function)&&"object"!=typeof c)throw new joice.ArgumentOutOfRangeException("implementation");b.ctor.call(this,b.setupArguments.apply(this,arguments))};a.Registration.dependencies=["serviceType","implementation"],Object.defineProperty(c.prototype,"_serviceType",{enumerable:!1,configurable:!1,writable:!0,value:null}),Object.defineProperty(c.prototype,"_implementationType",{enumerable:!1,configurable:!1,writable:!0,value:null}),Object.defineProperty(c.prototype,"_instance",{enumerable:!1,configurable:!1,writable:!0,value:null}),Object.defineProperty(c.prototype,"_factoryMethod",{enumerable:!1,configurable:!1,writable:!0,value:null}),Object.defineProperty(c.prototype,"_scope",{enumerable:!1,configurable:!1,writable:!0,value:null}),Object.defineProperty(c.prototype,"_name",{enumerable:!1,configurable:!1,writable:!0,value:null}),Object.defineProperty(c.prototype,"_dependencies",{enumerable:!1,configurable:!1,writable:!0,value:null}),c.toString=function(){return"joice.Registration"},b.setupArguments=function(a){for(var b={serviceType:a},c=1;c<arguments.length;c++){var d=arguments[c];void 0!==d&&null!==d&&(d instanceof joice.Scope?b.scope=d:"string"==typeof d?b.name=d:"boolean"==typeof d?d&&b.implementationType&&(b.factoryMethod=b.implementationType,delete b.implementationType):d instanceof Function?b[b.implementationIsFactoryMethod?"factoryMethod":"implementationType"]=d:"object"==typeof d&&(b.instance=d))}return b},b.ctor=function(a){if(a.instance)b.createInstanceImplementation.call(this,a.serviceType,a.instance,a.name,a.scope);else if(a.factoryMethod)b.createFactoryMethod.call(this,a.serviceType,a.factoryMethod,a.name,a.scope);else{if(!a.implementationType)throw new joice.InvalidOperationException("Parameters provided are not suitable to create a joice.Registration instance.");b.createImplementationType.call(this,a.serviceType,a.implementationType,a.name,a.scope)}this._dependencies=[],null===this._factoryMethod&&b.initialize.call(this)},b.createImplementationType=function(a,b,c,d){this._serviceType=a,this._implementationType=b,this._instance=null,this._factoryMethod=null,this._name=c||this._implementationType.toString(),this._scope=d||joice.Scope.Transient},b.createFactoryMethod=function(a,b,c,d){Function.requiresArgument("name",c,"string"),this._serviceType=a,this._implementationType=null,this._instance=null,this._factoryMethod=b,this._name=c,this._scope=d||joice.Scope.Transient},b.createInstanceImplementation=function(a,b,c,d){this._serviceType=a,this._implementationType=b.prototype,this._instance=b,this._factoryMethod=null,this._name=c||this._implementationType.toString(),this._scope=d||joice.Scope.Transient},b.initialize=function(){var a;if(this._implementationType.dependencies&&this._implementationType.dependencies instanceof Array)for(a=0;a<this._implementationType.dependencies.length;a++){var b=this._implementationType.dependencies[a].trim();0!==b.length&&this._dependencies.push(b)}else{var c=Function.prototype.toString.call(this._implementationType),d=c.match(/\(([^)]*)\)/);if(null!==d&&d.length>1)for(d=d[1].split(","),a=0;a<d.length;a++){var e=d[a].trim();0!==e.length&&this._dependencies.push(e)}}}}(namespace("joice")),function(a){"use strict";var b=(a.RegistrationsCollection=function(a){Array.prototype.constructor.apply(this,Array.prototype.slice.call(arguments,1)),this._owner=a||null})[":"](Array);a.RegistrationsCollection.dependencies=["owner"],Object.defineProperty(b.prototype,"_owner",{enumerable:!1,configurable:!1,writable:!0,value:null}),b.prototype.indexOf=function(a){if(a instanceof joice.Registration)return Array.prototype.indexOf.apply(this,arguments);if("string"==typeof a){for(var b=0;b<this.length;b++){var c=this[b];if(c._name===a)return b}return-1}},b.toString=function(){return"joice.RegistrationsCollection"}}(namespace("joice")),function(a){"use strict";var b=a.Scope=function(a){Function.requiresArgument("name",a,"string"),this.toString=function(){return a}};a.Scope.dependencies=["name"],b.toString=function(){return"joice.Scope"},b.Singleton=new b("singleton"),b.Transient=new b("transient")}(namespace("joice")),function(a){"use strict";var b=(a.TypeResolver=function(){})[":"](joice.Resolver);b.prototype.isApplicableTo=function(a){Function.requiresArgument("dependency",a,"string");var c=this.normalize.call(this,a,b.typeIndicators);return c!==a},b.prototype.resolve=function(a){var c=this.normalize.call(this,a,joice.ArrayResolver.arrayIndicators),d=a!==c;a=this.normalize.call(this,c,b.typeIndicators);var e=this.container.findServices(a);return d?e:e.length>0?e[0]:null},b.typeIndicators=["(.*)Type$","(.*)Types$"]}(namespace("joice"));